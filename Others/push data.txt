<div id="demo"></div>
<div id="iowa-map" style="height:97vh;"></div>

<script src="//www.amcharts.com/lib/4/core.js"></script>
<script src="//www.amcharts.com/lib/4/maps.js"></script>
<script src="//www.amcharts.com/lib/4/geodata/region/usa/iaLow.js"></script>
<script src = "//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<script>
var chart = am4core.create("iowa-map", "MapChart");
chart.geodata = am4geodata_region_usa_iaLow;
var map20 = chart.series.push(new am4maps.MapPolygonSeries());
map20.useGeodata = true;
map20.mapPolygons.template.propertyFields.fill = "fill";
map20.mapPolygons.template.tooltipText = "{total}";
map20.data = [{id:19001,state:"IA",total:208,cand1:"ברני סנדרס",fill:"#333"}];
</script>


<script>
var jsondata;
$.getJSON("//int.nyt.com/applications/elections/2020/data/api/2020-02-03/iowa/president/republican.json", function(json){
 jsondata = json;
});

var file = jsondata.data.races[0];
for (var i = 0; i <= 999999; i++) {
    document.getElementById("demo").innerHTML += "id:" + file.counties[i].fips + "," + "total:" + file.counties[i].votes + ",";
    var subfile = file.counties[i].results;
    keys = Object.keys(file.counties[i].results);
    for (var j = 0; j < Object.keys(file.counties[i].results).length; j++) {
        document.getElementById("demo").innerHTML += "cand" + j + ":" + keys[j] + "," + subfile[keys[j]] + ",";
        map20.data.push({id: file.counties[i].fips, total: file.counties[i].votes, fill:'#aaa'});
    }
    document.getElementById("demo").innerHTML += "<br/>";
}
</script>

